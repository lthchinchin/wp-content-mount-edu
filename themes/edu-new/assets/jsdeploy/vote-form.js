!function(l){"use strict";l(document).ready(function(){d(),l(".submit-favorite").keydown(function(t){13===t.keyCode&&t.preventDefault()});let o=!1;l(".submit-favorite button").on("mouseenter",function(){o=!0}),l(".submit-favorite button").on("mouseleave",function(){o=!1});const u={vote_date:"Đã hết thời hạn bình chọn!",valid_name:"Họ và tên không hợp lệ, họ và tên cho phép nhiều nhất 50 kí tự.",valid_phone:"Số điện thoại không hợp lệ.",valid_ticket:"Bạn phải chọn ít nhất 1 ứng viên, nhiều nhất 10 ứng viên.",valid_captcha:"Mã captcha không đúng.",success_vote:"Cảm ơn! Bạn đã bình chọn thành công!",fail_vote:"Lỗi! Bình chọn thất bại.\n ",confirm_vote:"Xác nhận bình chọn!"};l(".submit-favorite").submit(function(t){if(t.preventDefault(),o){var t=new Date,n=new Date(MYSCRIPT.closing_date);if(t.getTime()>=n.getTime()+864e5){m();const e=u.vote_date;void showConfirmation("alert",e)}else{const a=l(this).find('input[name="full_name"]');l(this).find('input[name="email"]');const i=l(this).find('input[name="phone_number"]'),c=l(this).find('input[name="token"]'),s=l(this).find('input[name="rdcaptcha_id"]'),r=l(this).find('input[name="rdcaptcha_value"]');let e="";showConfirmation("success",u.confirm_vote,function(){const o={...u};var t,n;t=l(".form_group input"),l(".form_group .mess").text(""),t.removeClass("err"),50<a.val().length&&(e=o.valid_name,a.addClass("err"),a.closest(".form_group").find(".mess").text(e)),t=i.val(),/^(0|\+84)[1-9][0-9]{8}$/.test(t)||(e=o.valid_phone,i.addClass("err"),i.closest(".form_group").find(".mess").text(e)),(e=myFavItems.length<1&&10<myFavItems.length?o.valid_ticket:e)?showConfirmation("alert",e,function(){}):MYSCRIPT.ENABLE_RESDII_CAPTCHA?(t=MYSCRIPT.RESDIICAPTCHA_SV+"vextsec/captcha/validate",n={clientId:MYSCRIPT.RESDIICAPTCHA_CLID,captchaId:s.val(),captchaValue:r.val()},l.ajax({url:t,type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(n),success:function(t){console.log(t),200===t.code&&(console.log("u are human",t.data.captchaToken),c.val(t.data.captchaToken),f(myFavItems,o))},error:function(t,n,e){var a=o.valid_captcha;r.addClass("err"),r.closest(".form_group").find(".mess").text(a),d()}})):f(myFavItems,o)})}}}),grecaptcha.ready(function(){grecaptcha.execute(MYSCRIPT.recaptcha_key,{action:"submit"}).then(function(t){document.getElementById("tokengg").value=t})})});var t=!0;function m(){localStorage.setItem("myFavCandidates",JSON.stringify([])),showCandidatePickedList([]),l(".submit-favorite")[0].reset()}function f(t,n={}){var e=l("form.submit-favorite").find('input[name="full_name"]');const a=l("form.submit-favorite").find('input[name="email"]');var o=l("form.submit-favorite").find('input[name="phone_number"]'),i=l("form.submit-favorite").find('input[name="token"]'),c=l("form.submit-favorite").find('input[name="tokengg"]');l.ajax({url:MYSCRIPT.ajaxUrl,type:"post",dataType:"json",data:{action:"vote_candidate",nonce:MYSCRIPT.nonce,myVote:t,userName:e.val(),email:a.val(),phoneNumber:o.val(),token:i.val(),tokengg:c.val()},success(t){204===t.status&&(a.val(""),a.focus(),showConfirmation("alert",t.data,function(){},function(){location.reload()})),200===t.status&&(m(),showConfirmation("alert",n.success_vote,function(){},function(){console.log(n.success_vote,"redirect to a new page"),location.reload()})),500===t.status&&(m(),showConfirmation("alert",n.fail_vote+t.data,function(){},function(){console.log(n.fail_vote),location.reload()})),console.log("res",t)}})}function d(){var t=MYSCRIPT.RESDIICAPTCHA_SV+"vextsec/captcha/generate",n={clientId:MYSCRIPT.RESDIICAPTCHA_CLID,width:200,height:50};l.ajax({url:t,type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(n),success:function(t){console.log(t),200===t.code&&(l("#load-rdcaptcha").html(t.data.captchaImage),l("form.submit-favorite").find('input[name="rdcaptcha_id"]').val(t.data.captchaId))}})}l("#btn-refresh-rdcaptcha").click(function(){t&&(t=!1,d(),setTimeout(()=>{t=!0},2e3))})}(jQuery);